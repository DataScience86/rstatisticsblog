<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?port=1313&mindelay=10&v=2" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="LASSO stands for Least Absolute Shrinkage and Selection Operator. The algorithm is another variation of linear regression, just like ridge regression. We use lasso regression when we have a large number of predictor variables.
 Overview - Lasso Regression Lasso regression is a parsimonious model that performs L1 regularization. The L1 regularization adds a penalty equivalent to the absolute magnitude of regression coefficients and tries to minimize them. The equation of lasso is similar to ridge regression and looks like as given below."><meta property="og:title" content="Lasso Regression" />
<meta property="og:description" content="LASSO stands for Least Absolute Shrinkage and Selection Operator. The algorithm is another variation of linear regression, just like ridge regression. We use lasso regression when we have a large number of predictor variables.
 Overview - Lasso Regression Lasso regression is a parsimonious model that performs L1 regularization. The L1 regularization adds a penalty equivalent to the absolute magnitude of regression coefficients and tries to minimize them. The equation of lasso is similar to ridge regression and looks like as given below." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/docs/foundational-algorithms/Lasso-Regression/" />
<meta property="article:published_time" content="2020-02-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-30T10:51:20+05:30" />
<title>Lasso Regression | R Statistics Blog</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.6df681b0bb21155cba49f6078e3559216772d8e03e780d240c73ea21817ed5e5.css" integrity="sha256-bfaBsLshFVy6SfYHjjVZIWdy2OA&#43;eA0kDHPqIYF&#43;1eU=">
<script defer src="/en.search.min.d57240dc8b064f390ea28d6a2ec3d38165e5dfc8433d2a750739a6c9c766d392.js" integrity="sha256-1XJA3IsGTzkOoo1qLsPTgWXl38hDPSp1Bzmmycdm05I="></script>

<script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" integrity="sha256-dKi7B/C&#43;6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-131766057-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="//localhost:1313/"><span>R Statistics Blog</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>






  
<ul>
  
  <li>
    <a href="" target="_blank" rel="noopener">
        
      </a>
  </li>
  
</ul>







  



  
  
  
  

  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
    <span>Quick R Tutorial</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/introduction-to-r/" class="">Getting Started</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/r-basics/" class="">R Basics</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/using-conditional-statements-and-loops/" class="">Conditions &amp; Loops</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/functions-and-apply-family/" class="">Its All About Functions</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/dataframe-manipulations/" class="">Data Frame Manipulations</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Useful R Packages</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/useful-r-packages/Quick-ggplot2-Tutorial/" class="">Tutorial ggplot2 Package</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/useful-r-packages/R-Tutorial-datatable-With-Examples/" class="">Tutorial data.table Package</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Pre Processing Tasks</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Identifying-Outliers/" class="">Analysing Outliers</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Missing-Value-Imputation/" class="">Missing Value Imputation</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Summarizing-Data/" class="">Summarizing data</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Hypothesis-Testing/" class="">Hypothesis Testing</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Correlation/" class="">Correlation</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Analysing-zero-variance-predictor/" class="">Analysing zero variance predictor</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Standardization-MinMax-Scaling/" class="">Standardization And Scaling</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Principal-Component-Analysis/" class="">Principal Component Analysis</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Splitting-Data/" class="">Splitting Data</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Foundational Algorithms</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Linear-Regression/" class="">Linear Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Ridge-Regression/" class="">Ridge Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Lasso-Regression/" class="active">Lasso Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Binary-Logistics-Regression/" class="">Binary Logistic Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Multinomial-Logistic-Regressions/" class="">Multinomial Logistic Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/k-means-clustering/" class="">k-Mean Clustering</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="/posts/" >
        Blog
      </a>
  </li>
  
  <li>
    <a href="https://github.com/DataScience86/rstatisticsblog/tree/master/content" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Lasso Regression</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#overview---lasso-regression">Overview - Lasso Regression</a>
      <ul>
        <li><a href="#what-does-a-large-number-of-variables-mean">What does a large number of variables mean?</a></li>
      </ul>
    </li>
    <li><a href="#training-lasso-regression-model">Training Lasso Regression Model</a>
      <ul>
        <li><a href="#sharing-the-r-squared-formula">Sharing the R Squared formula</a></li>
        <li><a href="#getting-the-list-of-important-variables">Getting the list of important variables</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><blockquote>
<p><strong>LASSO</strong> stands for <strong>Least Absolute Shrinkage and Selection Operator</strong>. The algorithm is another variation of linear regression, just like ridge regression. We use lasso regression when we have a large number of predictor variables.</p>
</blockquote>
<h1 id="overview---lasso-regression">Overview - Lasso Regression</h1>
<p>Lasso regression is a parsimonious model that performs L1 regularization. The L1 regularization adds a penalty equivalent to the absolute magnitude of regression coefficients and tries to minimize them. The equation of lasso is similar to ridge regression and looks like as given below.</p>
<pre><code>  LS Obj + λ (sum of the absolute values of coefficients)
</code></pre>
<p>Here the objective is as follows:
If λ = 0, We get the same coefficients as linear regression
If λ = vary large, All coefficients are shrunk towards zero</p>
<p>The two models, lasso and ridge regression, are almost similar to each other. However, in lasso, the coefficients which are responsible for large variance are converted to <em>zero</em>. On the other hand, coefficients are only shrunk but are never made zero in ridge regression.</p>
<p><strong>Lasso regression analysis is also used for variable selection as the model imposes coefficients of some variables to shrink towards zero.</strong></p>
<h2 id="what-does-a-large-number-of-variables-mean">What does a large number of variables mean?</h2>
<ol>
<li>The large number here means that the model tends to over-fit. Theoretically, a minimum of ten variables can cause an overfitting problem.</li>
<li>When you face computational challenges due to the presence of n number of variables. Although, given today&rsquo;s processing power of systems, this situation arises rarely.</li>
</ol>
<p><em>The following diagram is the visual interpretation comparing OLS and lasso regression</em>.</p>
<figure>
  <img src="/images/regression/lasso.JPG" alt="Geometric representation of OLS vs lasso Regression" >
</figure>
<br/>
<blockquote class="book-hint info">
  The LASSO is not very good at handling variables that show a correlation between them and thus can sometimes show very wild behavior.
</blockquote>

<h1 id="training-lasso-regression-model">Training Lasso Regression Model</h1>
<p>The training of the lasso regression model is exactly the same as that of ridge regression. We need to identify the optimal lambda value and then use that value to train the model. To achieve this, we can use the same <code>glmnet</code> function and pass<code>alpha = 1</code> argument. When we pass <code>alpha  = 0</code>, <code>glmnet()</code> runs a ridge regression, and when we pass <code>alpha = 0.5</code>, the glmnet runs another kind of model which is called as <strong>elastic net</strong> and is a combination of ridge and lasso regression.</p>
<ol>
<li>We use <code>cv.glmnet()</code> function to identify the optimal lambda value</li>
<li>Extract the best lambda and best model</li>
<li>Rebuild the model using <code>glmnet()</code> function</li>
<li>Use predict function to predict the values on future data</li>
</ol>
<p>For this example, we will be using <code>swiss</code> dataset to predict fertility based upon Socioeconomic Indicators for the year 1888.</p>
<pre><code># Loading the library
library(glmnet)

# Loading the data
data(swiss)

x_vars &lt;- model.matrix(Fertility~. , swiss)[,-1]
y_var &lt;- swiss$Fertility
lambda_seq &lt;- 10^seq(2, -2, by = -.1)

# Splitting the data into test and train
set.seed(86)
train = sample(1:nrow(x_var), nrow(x_var)/2)
x_test = (-train)
y_test = y_var[test]

cv_output &lt;- cv.glmnet(x_vars[train,], y_var[train],
            alpha = 1, lambda = lambda_seq)

# identifying best lamda
best_lam &lt;- cv_output$lambda.min
</code></pre><pre><code># Output
[1] 1.995262
</code></pre><p><em>Using this value, let us train the lasso model again</em>.</p>
<pre><code># Rebuilding the model with best lamda value identified
lasso_best &lt;- glmnet(x_vars[train,], y_var[train], alpha = 1, lambda = best_lam)
pred &lt;- predict(lasso_best, s = best_lam, newx = x_vars[test,])
</code></pre><p>Finally, we combine the predicted values and actual values to see the two values side by side, and then you can use the R-Squared formula to check the model performance. Note - you must calculate the R-Squared values for both the train and test dataset.</p>
<pre><code>final &lt;- cbind(y_var[test], pred)
# Checking the first six obs
head(final)
</code></pre><pre><code># Output
            Actual    Pred
Courtelary   80.2   69.92666
Delemont     83.1   76.15793
Franches-Mnt 92.5   75.16697
Moutier      85.8   70.33981
Glane        92.4   76.61480
Veveyse      87.1   76.34404
</code></pre><h2 id="sharing-the-r-squared-formula">Sharing the R Squared formula</h2>
<p><em>The function provided below is just indicative, and you must provide the actual and predicted values based upon your dataset</em>.</p>
<pre><code>actual &lt;- test$actual
preds &lt;- test$predicted
rss &lt;- sum((preds - actual) ^ 2)
tss &lt;- sum((actual - mean(actual)) ^ 2)
rsq &lt;- 1 - rss/tss
rsq
</code></pre><h2 id="getting-the-list-of-important-variables">Getting the list of important variables</h2>
<p>To get the list of important variables, we just need to investigate the beta coefficients of the final best model.</p>
<pre><code># Inspecting beta coefficients
coef(lasso_best)
</code></pre><pre><code># Output
6 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
                          s0
(Intercept)      55.16706057
Agriculture       .         
Examination      -0.30124968
Education         .         
Catholic          0.04700893
Infant.Mortality  0.84730322
</code></pre><p><em>The model indicates that the coefficients of Agriculture and Education have been shrunk to zero. Thus we are left with three variables, namely; Examination,  Catholic, and Infant.Mortality</em></p>
<p>In this chapter, we learned how to build a lasso regression using the same glmnet package, which we used to build the ridge regression. We also saw what&rsquo;s the difference between the ridge and the lasso is. In the next chapter, we will discuss how to predict a dichotomous variable using logistic regression.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">



  <div><a class="flex align-center" href="https://github.com/DataScience86/rstatisticsblog/tree/master/content/docs/commit/fabb964f9c6102dfd12c195a35f45ae618bd98a2" title='Last modified by datasciencebeginner | April 30, 2020' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>April 30, 2020</span>
    </a>
  </div>



</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#overview---lasso-regression">Overview - Lasso Regression</a>
      <ul>
        <li><a href="#what-does-a-large-number-of-variables-mean">What does a large number of variables mean?</a></li>
      </ul>
    </li>
    <li><a href="#training-lasso-regression-model">Training Lasso Regression Model</a>
      <ul>
        <li><a href="#sharing-the-r-squared-formula">Sharing the R Squared formula</a></li>
        <li><a href="#getting-the-list-of-important-variables">Getting the list of important variables</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












