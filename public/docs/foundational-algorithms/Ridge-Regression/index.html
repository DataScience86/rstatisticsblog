<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?port=1313&mindelay=10&v=2" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Ridge Regression is a variation of linear regression. We use ridge regression to tackle the multicollinearity problem. Due to multicollinearity, the model estimates (least square) see a large variance. Ridge regression is a method by which we add a degree of bias to the regression estimates.
 Overview - Ridge Regression Ridge regression is a parsimonious model that performs L2 regularization. The L2 regularization adds a penalty equivalent to the square of the magnitude of regression coefficients and tries to minimize them."><meta property="og:title" content="Ridge Regression" />
<meta property="og:description" content="Ridge Regression is a variation of linear regression. We use ridge regression to tackle the multicollinearity problem. Due to multicollinearity, the model estimates (least square) see a large variance. Ridge regression is a method by which we add a degree of bias to the regression estimates.
 Overview - Ridge Regression Ridge regression is a parsimonious model that performs L2 regularization. The L2 regularization adds a penalty equivalent to the square of the magnitude of regression coefficients and tries to minimize them." />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/docs/foundational-algorithms/Ridge-Regression/" />
<meta property="article:published_time" content="2020-03-29T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-07T22:32:54+05:30" />
<title>Ridge Regression | R Statistics Blog</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.6df681b0bb21155cba49f6078e3559216772d8e03e780d240c73ea21817ed5e5.css" integrity="sha256-bfaBsLshFVy6SfYHjjVZIWdy2OA&#43;eA0kDHPqIYF&#43;1eU=">
<script defer src="/en.search.min.467efe3ffa9e2f2aee9fac454f0b7e45a32868ba484ce71412abf7d8395b2a3b.js" integrity="sha256-Rn7&#43;P/qeLyrun6xFTwt&#43;RaMoaLpITOcUEqv32DlbKjs="></script>

<script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" integrity="sha256-dKi7B/C&#43;6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-131766057-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="//localhost:1313/"><span>R Statistics Blog</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>






  
<ul>
  
  <li>
    <a href="" target="_blank" rel="noopener">
        
      </a>
  </li>
  
</ul>







  



  
  
  
  

  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
    <a href="/docs/subscribe/" class="">Subscribe</a>
  

          
  
  
  

  
  <ul>
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Quick R Tutorial</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/introduction-to-r/" class="">Getting Started With R</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/r-basics/" class="">R Basics</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/using-conditional-statements-and-loops/" class="">Conditions &amp; Loops</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/functions-and-apply-family/" class="">Its All About Functions</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/quick-r-tutorial/dataframe-manipulations/" class="">Dataframe Manipulations</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Useful R Packages</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/useful-r-packages/ggplot2-tutorial/" class="">ggplot2</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/useful-r-packages/datatable-tutorial-data-manipulation/" class="">data.table</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/useful-r-packages/Leaftlet-Package-for-Maps/" class="">Leaftlet For Maps</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Pre Processing Tasks</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Identifying-Outliers/" class="">Analysing Outliers</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Missing-Value-Imputation/" class="">Missing Value Imputation</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Summarizing-Data/" class="">Summarizing Data</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Hypothesis-Testing/" class="">Hypothesis Testing</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Correlation/" class="">Correlation</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Analysing-zero-variance-predictor/" class="">Analysing zero variance predictor</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Standardization-MinMax-Scaling/" class="">Standardization And Scaling</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Principal-Component-Analysis/" class="">Principal Component Analysis</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/pre-processing-tasks/Splitting-Data/" class="">Splitting Data</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Foundational Algorithms</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Linear-Regression/" class="">Linear Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Ridge-Regression/" class="active">Ridge Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Lasso-Regression/" class="">Lasso Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Binary-Logistics-Regression/" class="">Binary Logistic Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/Multinomial-Logistic-Regressions/" class="">Multinomial Logistic Regression</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/foundational-algorithms/k-means-clustering/" class="">k-Mean Clustering</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
    <span>Text Mining</span>
  

          
  
  
  

  
  <ul>
    
      
        <li>
          
  
    <a href="/docs/text-mining/text-pre-processing/" class="">Text Pre-Processing</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/text-mining/word-document-analysis/" class="">Word and Document Analysis</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/text-mining/sentiment-analysis/" class="">Sentiment Analysis</a>
  

        </li>
      
    
      
        <li>
          
  
    <a href="/docs/text-mining/topic-modeling-lda/" class="">Topic Modeling</a>
  

        </li>
      
    
  </ul>
  

        </li>
      
    
  </ul>
  











  
<ul>
  
  <li>
    <a href="/posts/" >
        Blog
      </a>
  </li>
  
  <li>
    <a href="/privacy-policy/" >
        Privacy Policy
      </a>
  </li>
  
  <li>
    <a href="https://github.com/DataScience86/rstatisticsblog/tree/master/content" target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
  <li>
    <a href="/" >
        Privacy Policy
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Ridge Regression</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#overview---ridge-regression">Overview - Ridge Regression</a></li>
    <li><a href="#training-ridge-regression-model">Training Ridge Regression Model</a></li>
    <li><a href="#choosing-optimal-lambda-value">Choosing Optimal Lambda Value</a></li>
    <li><a href="#extracting-the-best-model-using-k-cross-validation">Extracting the best model using K-cross validation</a></li>
    <li><a href="#building-the-final-model">Building the final model</a>
      <ul>
        <li><a href="#checking-the-coefficients">Checking the coefficients</a></li>
      </ul>
    </li>
    <li><a href="#bias-and-variance-of-ridge-regression">Bias and variance of ridge regression</a></li>
    <li><a href="#assumptions-of-ridge-regressions">Assumptions of Ridge Regressions</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><blockquote>
<p><strong>Ridge Regression</strong> is a variation of linear regression. We use ridge regression to tackle the multicollinearity problem. Due to multicollinearity, the model estimates (least square) see a large variance. Ridge regression is a method by which we add a degree of bias to the regression estimates.</p>
</blockquote>
<h1 id="overview---ridge-regression">Overview - Ridge Regression</h1>
<p>Ridge regression is a parsimonious model that performs L2 regularization. The L2 regularization adds a penalty equivalent to the square of the magnitude of regression coefficients and tries to minimize them. The equation of ridge regression looks like as given below.</p>
<pre><code>  LS Obj + λ (sum of the square of coefficients)
</code></pre>
<p>Here the objective is as follows:</p>
<ol>
<li>
<p>If λ = 0, the output is similar to simple linear regression.</p>
</li>
<li>
<p>If λ = very large, the coefficients will become zero.</p>
</li>
</ol>
<p><em>The following diagram is the visual interpretation comparing OLS and ridge regression</em>.</p>
<figure>
  <img src="/images/regression/ridge.JPG" alt="Geometric representation of OLS vs Ridge Regression" >
</figure>
<h1 id="training-ridge-regression-model">Training Ridge Regression Model</h1>
<p>To build the ridge regression in r, we use <code>glmnet</code>function from <strong>glmnet</strong> package in R. Let&rsquo;s use ridge regression to predict the mileage of the car using mtcars dataset.</p>
<pre><code># Loaging the library
library(glmnet)
# Getting the independent variable
x_var &lt;- data.matrix(mtcars[, c(&quot;hp&quot;, &quot;wt&quot;, &quot;drat&quot;)])
# Getting the dependent variable
y_var &lt;- mtcars[, &quot;mpg&quot;]

# Setting the range of lambda values
lambda_seq &lt;- 10^seq(2, -2, by = -.1)
# Using glmnet function to build the ridge regression model
fit &lt;- glmnet(x_var, y_var, alpha = 0, lambda  = lambda_seq)
# Checking the model
summary(fit)
</code></pre><pre><code># Output
          Length Class     Mode   
a0         41    -none-    numeric
beta      123    dgCMatrix S4     
df         41    -none-    numeric
dim         2    -none-    numeric
lambda     41    -none-    numeric
dev.ratio  41    -none-    numeric
nulldev     1    -none-    numeric
npasses     1    -none-    numeric
jerr        1    -none-    numeric
offset      1    -none-    logical
call        5    -none-    call   
nobs        1    -none-    numeric
</code></pre><h1 id="choosing-optimal-lambda-value">Choosing Optimal Lambda Value</h1>
<p>The <code>glmnet</code> function trains the model multiple times for all the different values of lambda, which we pass as a sequence of vector to the <code>lambda =</code> argument in the <code>glmnet</code> function. The next task is to identify the optimal value of lambda that will result in a minimum error. This can be achieved automatically by using <code>cv.glmnet()</code> function.</p>
<pre><code># Using cross validation glmnet
ridge_cv &lt;- cv.glmnet(x_var, y_var, alpha = 0, lambda = lambdas)
# Best lambda value
best_lambda &lt;- ridge_cv$lambda.min
best_lambda
</code></pre><pre><code># Output
[1] 79.43000
</code></pre><h1 id="extracting-the-best-model-using-k-cross-validation">Extracting the best model using K-cross validation</h1>
<p>The best model can be extracted by calling the <code>glmnet.fit</code> from the cross-validation object.  Once you have that, we can rebuild the model by passing lambda as <strong>79.43000</strong>.</p>
<pre><code>best_fit &lt;- ridge_cv$glmnet.fit
head(best_fit)
</code></pre><pre><code># Output
      Df   %Dev    Lambda
 [1,]  3 0.1798 100.00000
 [2,]  3 0.2167  79.43000
 [3,]  3 0.2589  63.10000
 [4,]  3 0.3060  50.12000
 [5,]  3 0.3574  39.81000
 [6,]  3 0.4120  31.62000
</code></pre><h1 id="building-the-final-model">Building the final model</h1>
<pre><code># Rebuilding the model with optimal lambda value
best_ridge &lt;- glmnet(x_var, y_var, alpha = 0, lambda = 79.43000)
</code></pre><h2 id="checking-the-coefficients">Checking the coefficients</h2>
<pre><code>coef(best_ridge)
</code></pre><pre><code># Output
4 x 1 sparse Matrix of class &quot;dgCMatrix&quot;
                      s0
(Intercept) 20.099502946
hp          -0.004398609
wt          -0.344175261
drat         0.484807607
</code></pre><p>The next task is to use the predict function and compute the R2 value for both the train and test dataset. In this, the example we did not create the train and test split. So, I am only providing a sample code. However, you can read the 
  <a href="../linear-regression">linear regression</a> chapter to understand this step in detail.</p>
<pre><code># here x is the test dataset
pred &lt;- predict(best_ridge, s = best_lambda, newx = x)

# R squared formula
actual &lt;- test$Price
preds &lt;- test$PreditedPrice
rss &lt;- sum((preds - actual) ^ 2)
tss &lt;- sum((actual - mean(actual)) ^ 2)
rsq &lt;- 1 - rss/tss
rsq
</code></pre><h1 id="bias-and-variance-of-ridge-regression">Bias and variance of ridge regression</h1>
<p>Bias and variance trade-off is generally complicated when it comes to building ridge regression models on an actual dataset. However, following the general trend which I would like to highlight here:</p>
<ol>
<li>The bias increases as λ increases.</li>
<li>The variance decreases as λ increases.</li>
</ol>
<h1 id="assumptions-of-ridge-regressions">Assumptions of Ridge Regressions</h1>
<p>The assumptions of ridge regression are the same as that of linear regression:  linearity, constant variance, and independence. However, as ridge regression does not provide confidence limits, the distribution of errors to be normal need not be assumed.</p>
<p>In this chapter, we learned about ridge regression in R using functions from glmnet package. We also saw how to use cross-validation to get the best model. In the next chapter, we will learn how to lasso regression.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">



  <div><a class="flex align-center" href="https://github.com/DataScience86/rstatisticsblog/tree/master/content/docs/commit/75c59771040bea9bcb25ff3452df524c96f42bd1" title='Last modified by datasciencebeginner | May 7, 2020' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>May 7, 2020</span>
    </a>
  </div>



</div>

 
        
      </footer>

      
  
  <div class="book-comments">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "rstatisticsblog-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#overview---ridge-regression">Overview - Ridge Regression</a></li>
    <li><a href="#training-ridge-regression-model">Training Ridge Regression Model</a></li>
    <li><a href="#choosing-optimal-lambda-value">Choosing Optimal Lambda Value</a></li>
    <li><a href="#extracting-the-best-model-using-k-cross-validation">Extracting the best model using K-cross validation</a></li>
    <li><a href="#building-the-final-model">Building the final model</a>
      <ul>
        <li><a href="#checking-the-coefficients">Checking the coefficients</a></li>
      </ul>
    </li>
    <li><a href="#bias-and-variance-of-ridge-regression">Bias and variance of ridge regression</a></li>
    <li><a href="#assumptions-of-ridge-regressions">Assumptions of Ridge Regressions</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












